<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trimint - Telegram Mini App</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- TON Connect SDK -->
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    
    <!-- Monetag Ads -->
    <script src='//libtl.com/sdk.js' data-zone='10290264' data-sdk='show_10290264'></script>
    
    <style>
        :root {
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --accent-color: #ec4899;
            --background-color: #f8fafc;
            --card-background: #ffffff;
            --text-color: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --coin-size: 120px;
        }

        [data-theme="dark"] {
            --background-color: #0f172a;
            --card-background: #1e293b;
            --text-color: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-bottom: 70px;
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--background-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .coin-loader {
            width: 100px;
            height: 100px;
            background-image: url('https://i.postimg.cc/fTQktNmX/maincoin.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            animation: pulse 1.5s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 18px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .referrer-message {
            margin-top: 10px;
            font-size: 16px;
            color: var(--accent-color);
            text-align: center;
            max-width: 80%;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-title {
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .header-title img {
            width: 30px;
            height: 30px;
            margin-right: 10px;
        }

        .balance-container {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
        }

        .balance-coin {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }

        .balance-amount {
            font-weight: bold;
            font-size: 16px;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
            padding: 5px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        main {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Section */
        .home-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px 0;
        }

        .coin-display {
            width: var(--coin-size);
            height: var(--coin-size);
            background-image: url('https://i.postimg.cc/fTQktNmX/maincoin.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin-bottom: 30px;
            position: relative;
            transition: transform 0.3s ease;
        }

        .coin-display:hover {
            transform: scale(1.05);
        }

        .coin-display.farming {
            animation: rotate3d 2s infinite linear;
        }

        @keyframes rotate3d {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .token-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            font-size: 18px;
            color: var(--success-color);
            opacity: 0;
            pointer-events: none;
        }

        .token-animation.show {
            animation: tokenFloat 1s ease-out forwards;
        }

        @keyframes tokenFloat {
            0% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -150%); }
        }

        .farming-button {
            background: linear-gradient(135deg, var(--success-color), #059669);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .farming-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .farming-button:active {
            transform: translateY(0);
        }

        .farming-button:disabled {
            background: linear-gradient(135deg, var(--text-secondary), #475569);
            cursor: not-allowed;
        }

        .farming-timer {
            font-size: 16px;
            color: var(--text-secondary);
            margin-top: 10px;
        }

        .farming-info {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            width: 100%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .farming-info h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .farming-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--text-color);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Tasks Section */
        .tasks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .tasks-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .task-card {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            transition: transform 0.2s ease;
        }

        .task-card:hover {
            transform: translateY(-2px);
        }

        .task-image {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            object-fit: cover;
            margin-right: 15px;
        }

        .task-details {
            flex: 1;
        }

        .task-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .task-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .task-reward {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: var(--success-color);
            font-weight: bold;
        }

        .task-reward img {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }

        .task-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .task-button:hover {
            background-color: var(--secondary-color);
        }

        .task-button.processing {
            background-color: var(--warning-color);
        }

        .task-button.completed {
            background-color: var(--text-secondary);
        }

        /* Leaderboard Section */
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .leaderboard-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .leaderboard-tabs {
            display: flex;
            margin-bottom: 20px;
            background-color: var(--card-background);
            border-radius: 10px;
            overflow: hidden;
        }

        .leaderboard-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: bold;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }

        .leaderboard-tab.active {
            background-color: var(--primary-color);
            color: white;
        }

        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .leaderboard-item {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .leaderboard-rank {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin-right: 15px;
            border-radius: 50%;
        }

        .rank-1 {
            background-color: #ffd700;
            color: #333;
        }

        .rank-2 {
            background-color: #c0c0c0;
            color: #333;
        }

        .rank-3 {
            background-color: #cd7f32;
            color: white;
        }

        .leaderboard-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }

        .leaderboard-info {
            flex: 1;
        }

        .leaderboard-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .leaderboard-level {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .leaderboard-balance {
            display: flex;
            align-items: center;
            font-weight: bold;
        }

        .leaderboard-balance img {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }

        /* Friends Section */
        .friends-header {
            margin-bottom: 20px;
        }

        .friends-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .referral-link-container {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .referral-link-label {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .referral-link {
            display: flex;
            align-items: center;
            background-color: var(--background-color);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .referral-link-text {
            flex: 1;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .copy-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            margin-left: 10px;
        }

        .referral-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .referral-stat {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            flex: 1;
            margin: 0 5px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .referral-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .referral-stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .referrals-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .referral-item {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .referral-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }

        .referral-info {
            flex: 1;
        }

        .referral-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .referral-details {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .referral-reward {
            display: flex;
            align-items: center;
            font-weight: bold;
            color: var(--success-color);
        }

        .referral-reward img {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }

        /* Profile Section */
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .profile-level {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .level-bronze {
            background-color: #cd7f32;
            color: white;
        }

        .level-gold {
            background-color: #ffd700;
            color: #333;
        }

        .level-diamond {
            background-color: #b9f2ff;
            color: #333;
        }

        .profile-id {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .profile-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .profile-stat {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 15px;
            flex: 1;
            margin: 0 5px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .profile-stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .profile-stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .wallet-section {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .wallet-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .wallet-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: background-color 0.2s ease;
        }

        .wallet-button:hover {
            background-color: var(--secondary-color);
        }

        .wallet-connected {
            display: none;
        }

        .wallet-address {
            background-color: var(--background-color);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            word-break: break-all;
        }

        .wallet-actions {
            display: flex;
            gap: 10px;
        }

        .wallet-action-button {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .copy-wallet-button {
            background-color: var(--primary-color);
            color: white;
        }

        .disconnect-wallet-button {
            background-color: var(--error-color);
            color: white;
        }

        .settings-section {
            background-color: var(--card-background);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .settings-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 16px;
        }

        .setting-toggle {
            position: relative;
            width: 50px;
            height: 26px;
            background-color: var(--border-color);
            border-radius: 13px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .setting-toggle.active {
            background-color: var(--primary-color);
        }

        .setting-toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.2s ease;
        }

        .setting-toggle.active .setting-toggle-slider {
            transform: translateX(24px);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--card-background);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }

        .nav-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            color: var(--text-secondary);
            transition: color 0.2s ease;
        }

        .nav-button.active {
            color: var(--primary-color);
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 5px;
        }

        .nav-button.home .nav-icon {
            width: 32px;
            height: 32px;
        }

        .nav-label {
            font-size: 12px;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--card-background);
            color: var(--text-color);
            padding: 12px 20px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 200;
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 80%;
            text-align: center;
        }

        .toast.show {
            opacity: 1;
        }

        .toast.success {
            background-color: var(--success-color);
            color: white;
        }

        .toast.error {
            background-color: var(--error-color);
            color: white;
        }

        .toast.warning {
            background-color: var(--warning-color);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .profile-stats, .referral-stats {
                flex-direction: column;
            }
            
            .profile-stat, .referral-stat {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="coin-loader"></div>
        <div class="loading-text">Loading Trimint...</div>
        <div class="referrer-message" id="referrerMessage"></div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-title">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM Coin">
            Trimint
        </div>
        <div class="balance-container">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM Coin" class="balance-coin">
            <span class="balance-amount" id="headerBalance">0 TRM</span>
        </div>
        <button class="theme-toggle" id="themeToggle">ðŸŒ™</button>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Section -->
        <section class="section active" id="homeSection">
            <div class="home-container">
                <div class="coin-display" id="coinDisplay">
                    <div class="token-animation" id="tokenAnimation">+0.001 TRM</div>
                </div>
                <button class="farming-button" id="farmingButton">Start Farming</button>
                <div class="farming-timer" id="farmingTimer"></div>
                
                <div class="farming-info">
                    <h3>Farming Info</h3>
                    <div class="farming-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="farmingRate">0.001</div>
                            <div class="stat-label">TRM/sec</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalEarned">0</div>
                            <div class="stat-label">Total Earned</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="farmingSessions">0</div>
                            <div class="stat-label">Sessions</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tasks Section -->
        <section class="section" id="tasksSection">
            <div class="tasks-header">
                <h2 class="tasks-title">Tasks</h2>
            </div>
            
            <div class="task-card" id="watchAdsTask">
                <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Watch Ads" class="task-image">
                <div class="task-details">
                    <div class="task-name">Watch Ads</div>
                    <div class="task-description">Watch an advertisement to earn TRM tokens</div>
                    <div class="task-reward">
                        <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                        <span>1 TRM</span>
                    </div>
                </div>
                <button class="task-button" id="watchAdsButton">OPEN</button>
            </div>
            
            <div id="tasksList"></div>
        </section>

        <!-- Leaderboard Section -->
        <section class="section" id="leaderboardSection">
            <div class="leaderboard-header">
                <h2 class="leaderboard-title">Leaderboard</h2>
            </div>
            
            <div class="leaderboard-tabs">
                <button class="leaderboard-tab active" data-period="daily">Daily</button>
                <button class="leaderboard-tab" data-period="weekly">Weekly</button>
                <button class="leaderboard-tab" data-period="all-time">All Time</button>
            </div>
            
            <div class="leaderboard-list" id="leaderboardList"></div>
        </section>

        <!-- Friends Section -->
        <section class="section" id="friendsSection">
            <div class="friends-header">
                <h2 class="friends-title">Friends</h2>
            </div>
            
            <div class="referral-link-container">
                <div class="referral-link-label">Your Referral Link</div>
                <div class="referral-link">
                    <div class="referral-link-text" id="referralLinkText">https://t.me/TrimintBot/open?startapp=</div>
                    <button class="copy-button" id="copyReferralButton">Copy</button>
                </div>
            </div>
            
            <div class="referral-stats">
                <div class="referral-stat">
                    <div class="referral-stat-value" id="totalReferrals">0</div>
                    <div class="referral-stat-label">Total Referrals</div>
                </div>
                <div class="referral-stat">
                    <div class="referral-stat-value" id="referralEarnings">0</div>
                    <div class="referral-stat-label">Referral Earnings</div>
                </div>
            </div>
            
            <div class="referrals-list" id="referralsList"></div>
        </section>

        <!-- Profile Section -->
        <section class="section" id="profileSection">
            <div class="profile-header">
                <img src="" alt="Profile" class="profile-avatar" id="profileAvatar">
                <div class="profile-info">
                    <div class="profile-name" id="profileName">Loading...</div>
                    <div class="profile-level level-bronze" id="profileLevel">Bronze</div>
                    <div class="profile-id" id="profileId">ID: </div>
                </div>
            </div>
            
            <div class="profile-stats">
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profileBalance">0</div>
                    <div class="profile-stat-label">Balance</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profileFriends">0</div>
                    <div class="profile-stat-label">Friends</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profileTasks">0</div>
                    <div class="profile-stat-label">Tasks</div>
                </div>
            </div>
            
            <div class="wallet-section">
                <h3 class="wallet-title">TON Wallet</h3>
                <button class="wallet-button" id="connectWalletButton">Connect TON Wallet</button>
                <div class="wallet-connected" id="walletConnected">
                    <div class="wallet-address" id="walletAddress"></div>
                    <div class="wallet-actions">
                        <button class="wallet-action-button copy-wallet-button" id="copyWalletButton">Copy</button>
                        <button class="wallet-action-button disconnect-wallet-button" id="disconnectWalletButton">Disconnect</button>
                    </div>
                </div>
            </div>
            
            <div class="settings-section">
                <h3 class="settings-title">Settings</h3>
                <div class="setting-item">
                    <div class="setting-label">Notifications</div>
                    <div class="setting-toggle active" id="notificationsToggle">
                        <div class="setting-toggle-slider"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Sound Effects</div>
                    <div class="setting-toggle active" id="soundToggle">
                        <div class="setting-toggle-slider"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Auto Farming</div>
                    <div class="setting-toggle" id="autoFarmingToggle">
                        <div class="setting-toggle-slider"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-button home active" data-section="homeSection">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Home" class="nav-icon">
            <span class="nav-label">Home</span>
        </button>
        <button class="nav-button tasks" data-section="tasksSection">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Tasks" class="nav-icon">
            <span class="nav-label">Tasks</span>
        </button>
        <button class="nav-button leaderboard" data-section="leaderboardSection">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Leaderboard" class="nav-icon">
            <span class="nav-label">Leaderboard</span>
        </button>
        <button class="nav-button friends" data-section="friendsSection">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Friends" class="nav-icon">
            <span class="nav-label">Friends</span>
        </button>
        <button class="nav-button profile" data-section="profileSection">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="Profile" class="nav-icon">
            <span class="nav-label">Profile</span>
        </button>
    </nav>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAt9PRbvok0g5XL4187btrPvGx6VjfurJU",
            authDomain: "msc-by-shawon.firebaseapp.com",
            projectId: "msc-by-shawon",
            storageBucket: "msc-by-shawon.firebasestorage.app",
            messagingSenderId: "432753389120",
            appId: "1:432753389120:web:dcbb46ca39408a405579a5",
            measurementId: "G-8LHGLJSSEE"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Telegram Web App initialization
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // TON Connect initialization
        let tonConnectUI;
        let walletConnected = false;
        let walletAddress = '';

        // User data
        let userData = {
            id: tg.initDataUnsafe?.user?.id || Math.floor(Math.random() * 1000000),
            firstName: tg.initDataUnsafe?.user?.first_name || 'User',
            lastName: tg.initDataUnsafe?.user?.last_name || '',
            username: tg.initDataUnsafe?.user?.username || '',
            photoUrl: tg.initDataUnsafe?.user?.photo_url || '',
            balance: 0,
            level: 'Bronze',
            totalFriends: 0,
            totalTasks: 0,
            farmingActive: false,
            farmingEndTime: null,
            totalEarned: 0,
            farmingSessions: 0,
            referrals: [],
            completedTasks: [],
            referralCode: '',
            referredBy: null,
            settings: {
                notifications: true,
                sound: true,
                autoFarming: false
            }
        };

        // Check for referrer
        const urlParams = new URLSearchParams(window.location.search);
        const startAppParam = urlParams.get('startapp');
        if (startAppParam) {
            userData.referredBy = startAppParam;
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            initializeNavigation();
            initializeTonConnect();
            loadUserData();
            initializeFarming();
            initializeTasks();
            initializeLeaderboard();
            initializeFriends();
            initializeProfile();
            initializeSettings();
            
            // Hide loading screen after a short delay
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                
                // Show referrer message if applicable
                if (userData.referredBy) {
                    showReferrerMessage();
                }
            }, 1500);
        });

        // Theme initialization
        function initializeTheme() {
            const themeToggle = document.getElementById('themeToggle');
            const savedTheme = localStorage.getItem('theme') || 'light';
            
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggle.textContent = 'â˜€ï¸';
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'ðŸŒ™';
            }
            
            themeToggle.addEventListener('click', function() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                themeToggle.textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
            });
        }

        // Navigation initialization
        function initializeNavigation() {
            const navButtons = document.querySelectorAll('.nav-button');
            const sections = document.querySelectorAll('.section');
            
            navButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetSectionId = this.getAttribute('data-section');
                    
                    // Update active button
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active section
                    sections.forEach(section => section.classList.remove('active'));
                    document.getElementById(targetSectionId).classList.add('active');
                    
                    // Load section-specific data
                    if (targetSectionId === 'leaderboardSection') {
                        loadLeaderboardData('daily');
                    } else if (targetSectionId === 'friendsSection') {
                        loadReferralsData();
                    } else if (targetSectionId === 'tasksSection') {
                        loadTasksData();
                    }
                });
            });
        }

        // TON Connect initialization
        function initializeTonConnect() {
            tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
                manifestUrl: 'https://trimint.vercel.app/tonconnect-manifest.json',
                buttonRootId: null
            });
            
            tonConnectUI.onStatusChange(wallet => {
                if (wallet) {
                    walletConnected = true;
                    walletAddress = wallet.account.address;
                    updateWalletUI();
                } else {
                    walletConnected = false;
                    walletAddress = '';
                    updateWalletUI();
                }
            });
            
            const connectWalletButton = document.getElementById('connectWalletButton');
            const disconnectWalletButton = document.getElementById('disconnectWalletButton');
            const copyWalletButton = document.getElementById('copyWalletButton');
            
            connectWalletButton.addEventListener('click', async () => {
                if (!walletConnected) {
                    await tonConnectUI.connectWallet();
                }
            });
            
            disconnectWalletButton.addEventListener('click', async () => {
                await tonConnectUI.disconnect();
            });
            
            copyWalletButton.addEventListener('click', () => {
                navigator.clipboard.writeText(walletAddress)
                    .then(() => {
                        showToast('Wallet address copied to clipboard', 'success');
                    })
                    .catch(err => {
                        console.error('Failed to copy wallet address: ', err);
                        showToast('Failed to copy wallet address', 'error');
                    });
            });
        }

        // Update wallet UI
        function updateWalletUI() {
            const connectWalletButton = document.getElementById('connectWalletButton');
            const walletConnectedDiv = document.getElementById('walletConnected');
            const walletAddressDiv = document.getElementById('walletAddress');
            
            if (walletConnected) {
                connectWalletButton.style.display = 'none';
                walletConnectedDiv.style.display = 'block';
                walletAddressDiv.textContent = walletAddress;
            } else {
                connectWalletButton.style.display = 'block';
                connectWalletButton.textContent = 'Connect TON Wallet';
                walletConnectedDiv.style.display = 'none';
            }
        }

        // Load user data from Firebase
        function loadUserData() {
            const userRef = database.ref('users/' + userData.id);
            
            userRef.once('value', (snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    userData = { ...userData, ...data };
                    
                    // Check for new referral
                    if (userData.referredBy && !userData.referralProcessed) {
                        processReferral();
                    }
                } else {
                    // New user, create record
                    userData.referralCode = generateReferralCode();
                    userRef.set(userData);
                }
                
                updateUI();
            });
            
            // Listen for changes
            userRef.on('value', (snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    userData = { ...userData, ...data };
                    updateUI();
                }
            });
        }

        // Update UI with user data
        function updateUI() {
            // Update header balance
            document.getElementById('headerBalance').textContent = `${userData.balance.toFixed(3)} TRM`;
            
            // Update profile
            document.getElementById('profileName').textContent = `${userData.firstName} ${userData.lastName}`;
            document.getElementById('profileId').textContent = `ID: ${userData.id}`;
            document.getElementById('profileAvatar').src = userData.photoUrl || 'https://i.postimg.cc/fTQktNmX/maincoin.png';
            document.getElementById('profileBalance').textContent = userData.balance.toFixed(3);
            document.getElementById('profileFriends').textContent = userData.totalFriends;
            document.getElementById('profileTasks').textContent = userData.totalTasks;
            
            // Update level
            updateLevel();
            
            // Update referral link
            document.getElementById('referralLinkText').textContent = `https://t.me/TrimintBot/open?startapp=${userData.id}`;
            
            // Update referral stats
            document.getElementById('totalReferrals').textContent = userData.referrals.length;
            
            // Update farming stats
            document.getElementById('totalEarned').textContent = userData.totalEarned.toFixed(3);
            document.getElementById('farmingSessions').textContent = userData.farmingSessions;
            
            // Update settings
            document.getElementById('notificationsToggle').classList.toggle('active', userData.settings.notifications);
            document.getElementById('soundToggle').classList.toggle('active', userData.settings.sound);
            document.getElementById('autoFarmingToggle').classList.toggle('active', userData.settings.autoFarming);
        }

        // Update user level based on balance
        function updateLevel() {
            let level = 'Bronze';
            let levelClass = 'level-bronze';
            
            if (userData.balance >= 50000) {
                level = 'Diamond';
                levelClass = 'level-diamond';
            } else if (userData.balance >= 10000) {
                level = 'Gold';
                levelClass = 'level-gold';
            }
            
            userData.level = level;
            document.getElementById('profileLevel').textContent = level;
            document.getElementById('profileLevel').className = `profile-level ${levelClass}`;
        }

        // Generate referral code
        function generateReferralCode() {
            return Math.random().toString(36).substring(2, 10);
        }

        // Process referral
        function processReferral() {
            if (!userData.referredBy) return;
            
            const referrerRef = database.ref('users/' + userData.referredBy);
            
            referrerRef.once('value', (snapshot) => {
                if (snapshot.exists()) {
                    const referrerData = snapshot.val();
                    
                    // Add 5000 TRM to referrer
                    const updatedBalance = referrerData.balance + 5000;
                    const updatedReferralEarnings = (referrerData.referralEarnings || 0) + 5000;
                    
                    // Add new referral to referrer's list
                    const newReferral = {
                        id: userData.id,
                        name: `${userData.firstName} ${userData.lastName}`,
                        username: userData.username,
                        photoUrl: userData.photoUrl,
                        joinedAt: new Date().toISOString(),
                        earned: 0
                    };
                    
                    const updatedReferrals = [...(referrerData.referrals || []), newReferral];
                    
                    // Update referrer data
                    referrerRef.update({
                        balance: updatedBalance,
                        referralEarnings: updatedReferralEarnings,
                        referrals: updatedReferrals,
                        totalFriends: updatedReferrals.length
                    });
                    
                    // Mark referral as processed
                    database.ref('users/' + userData.id).update({
                        referralProcessed: true
                    });
                    
                    showToast(`You were referred by ${referrerData.firstName}!`, 'success');
                }
            });
        }

        // Show referrer message on loading screen
        function showReferrerMessage() {
            if (!userData.referredBy) return;
            
            const referrerRef = database.ref('users/' + userData.referredBy);
            
            referrerRef.once('value', (snapshot) => {
                if (snapshot.exists()) {
                    const referrerData = snapshot.val();
                    document.getElementById('referrerMessage').textContent = `Referred by ${referrerData.firstName}`;
                }
            });
        }

        // Initialize farming
        function initializeFarming() {
            const farmingButton = document.getElementById('farmingButton');
            const farmingTimer = document.getElementById('farmingTimer');
            const coinDisplay = document.getElementById('coinDisplay');
            const tokenAnimation = document.getElementById('tokenAnimation');
            
            // Check if farming is already active
            if (userData.farmingActive && userData.farmingEndTime) {
                const endTime = new Date(userData.farmingEndTime);
                const now = new Date();
                
                if (endTime > now) {
                    startFarming(endTime);
                } else {
                    // Farming period ended
                    userData.farmingActive = false;
                    userData.farmingEndTime = null;
                    saveUserData();
                }
            }
            
            farmingButton.addEventListener('click', () => {
                if (!userData.farmingActive) {
                    // Start farming for 12 hours
                    const endTime = new Date();
                    endTime.setHours(endTime.getHours() + 12);
                    
                    startFarming(endTime);
                }
            });
            
            function startFarming(endTime) {
                userData.farmingActive = true;
                userData.farmingEndTime = endTime.toISOString();
                userData.farmingSessions++;
                saveUserData();
                
                farmingButton.textContent = 'Farming...';
                farmingButton.disabled = true;
                coinDisplay.classList.add('farming');
                
                const farmingInterval = setInterval(() => {
                    const now = new Date();
                    
                    if (now >= endTime) {
                        // Farming period ended
                        clearInterval(farmingInterval);
                        
                        userData.farmingActive = false;
                        userData.farmingEndTime = null;
                        saveUserData();
                        
                        farmingButton.textContent = 'Start Farming';
                        farmingButton.disabled = false;
                        coinDisplay.classList.remove('farming');
                        farmingTimer.textContent = '';
                        
                        showToast('Farming completed! You can start again.', 'success');
                        return;
                    }
                    
                    // Update balance
                    userData.balance += 0.001;
                    userData.totalEarned += 0.001;
                    
                    // Show token animation
                    tokenAnimation.classList.add('show');
                    setTimeout(() => {
                        tokenAnimation.classList.remove('show');
                    }, 1000);
                    
                    // Update UI
                    updateUI();
                    
                    // Update timer
                    const remainingTime = Math.floor((endTime - now) / 1000);
                    const hours = Math.floor(remainingTime / 3600);
                    const minutes = Math.floor((remainingTime % 3600) / 60);
                    const seconds = remainingTime % 60;
                    
                    farmingTimer.textContent = `Time remaining: ${hours}h ${minutes}m ${seconds}s`;
                }, 1000);
            }
        }

        // Initialize tasks
        function initializeTasks() {
            const watchAdsButton = document.getElementById('watchAdsButton');
            
            watchAdsButton.addEventListener('click', () => {
                if (watchAdsButton.textContent === 'OPEN') {
                    // Show ad
                    showAd();
                    
                    watchAdsButton.textContent = 'PROCESSING';
                    watchAdsButton.classList.add('processing');
                    
                    // After 10 seconds, complete the task
                    setTimeout(() => {
                        if (!userData.completedTasks.includes('watchAds')) {
                            userData.balance += 1;
                            userData.totalTasks++;
                            userData.completedTasks.push('watchAds');
                            saveUserData();
                            updateUI();
                        }
                        
                        watchAdsButton.textContent = 'COMPLETED';
                        watchAdsButton.classList.remove('processing');
                        watchAdsButton.classList.add('completed');
                        
                        showToast('You earned 1 TRM!', 'success');
                    }, 10000);
                } else if (watchAdsButton.textContent === 'COMPLETED') {
                    // Still redirect to link
                    showAd();
                }
            });
            
            // Check if watch ads task is completed
            if (userData.completedTasks.includes('watchAds')) {
                watchAdsButton.textContent = 'COMPLETED';
                watchAdsButton.classList.add('completed');
            }
            
            loadTasksData();
        }

        // Show ad
        function showAd() {
            // This is where you would integrate the Monetag ads
            // For demonstration, we'll just open a placeholder
            window.open('https://example.com/ad', '_blank');
        }

        // Load tasks data from Firebase
        function loadTasksData() {
            const tasksRef = database.ref('tasks');
            
            tasksRef.on('value', (snapshot) => {
                const tasksList = document.getElementById('tasksList');
                tasksList.innerHTML = '';
                
                if (snapshot.exists()) {
                    const tasks = snapshot.val();
                    
                    Object.keys(tasks).forEach(taskId => {
                        const task = tasks[taskId];
                        
                        // Check if task is completed
                        const isCompleted = userData.completedTasks.includes(taskId);
                        
                        const taskCard = document.createElement('div');
                        taskCard.className = 'task-card';
                        
                        taskCard.innerHTML = `
                            <img src="${task.image}" alt="${task.name}" class="task-image">
                            <div class="task-details">
                                <div class="task-name">${task.name}</div>
                                <div class="task-description">${task.description}</div>
                                <div class="task-reward">
                                    <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                                    <span>${task.reward} TRM</span>
                                </div>
                            </div>
                            <button class="task-button ${isCompleted ? 'completed' : ''}" data-task-id="${taskId}" data-task-link="${task.link}" data-task-reward="${task.reward}">
                                ${isCompleted ? 'COMPLETED' : 'OPEN'}
                            </button>
                        `;
                        
                        tasksList.appendChild(taskCard);
                    });
                    
                    // Add event listeners to task buttons
                    document.querySelectorAll('.task-button[data-task-id]').forEach(button => {
                        button.addEventListener('click', handleTaskClick);
                    });
                }
            });
        }

        // Handle task button click
        function handleTaskClick(event) {
            const button = event.target;
            const taskId = button.getAttribute('data-task-id');
            const taskLink = button.getAttribute('data-task-link');
            const taskReward = parseFloat(button.getAttribute('data-task-reward'));
            
            if (button.textContent === 'OPEN') {
                // Open task link
                window.open(taskLink, '_blank');
                
                button.textContent = 'PROCESSING';
                button.classList.add('processing');
                
                // After 10 seconds, complete the task
                setTimeout(() => {
                    if (!userData.completedTasks.includes(taskId)) {
                        userData.balance += taskReward;
                        userData.totalTasks++;
                        userData.completedTasks.push(taskId);
                        saveUserData();
                        updateUI();
                    }
                    
                    button.textContent = 'COMPLETED';
                    button.classList.remove('processing');
                    button.classList.add('completed');
                    
                    showToast(`You earned ${taskReward} TRM!`, 'success');
                }, 10000);
            } else if (button.textContent === 'COMPLETED') {
                // Still redirect to link
                window.open(taskLink, '_blank');
            }
        }

        // Initialize leaderboard
        function initializeLeaderboard() {
            const leaderboardTabs = document.querySelectorAll('.leaderboard-tab');
            
            leaderboardTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    leaderboardTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const period = tab.getAttribute('data-period');
                    loadLeaderboardData(period);
                });
            });
            
            // Load initial data
            loadLeaderboardData('daily');
        }

        // Load leaderboard data from Firebase
        function loadLeaderboardData(period) {
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = '';
            
            // Get users sorted by balance
            const usersRef = database.ref('users').orderByChild('balance').limitToLast(25);
            
            usersRef.once('value', (snapshot) => {
                if (snapshot.exists()) {
                    const users = [];
                    snapshot.forEach(childSnapshot => {
                        users.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    
                    // Sort by balance descending
                    users.sort((a, b) => b.balance - a.balance);
                    
                    // Create leaderboard items
                    users.forEach((user, index) => {
                        const rank = index + 1;
                        const rankClass = rank <= 3 ? `rank-${rank}` : '';
                        
                        const leaderboardItem = document.createElement('div');
                        leaderboardItem.className = 'leaderboard-item';
                        
                        leaderboardItem.innerHTML = `
                            <div class="leaderboard-rank ${rankClass}">${rank}</div>
                            <img src="${user.photoUrl || 'https://i.postimg.cc/fTQktNmX/maincoin.png'}" alt="${user.firstName}" class="leaderboard-avatar">
                            <div class="leaderboard-info">
                                <div class="leaderboard-name">${user.firstName} ${user.lastName}</div>
                                <div class="leaderboard-level">${user.level || 'Bronze'}</div>
                            </div>
                            <div class="leaderboard-balance">
                                <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                                <span>${user.balance.toFixed(3)}</span>
                            </div>
                        `;
                        
                        leaderboardList.appendChild(leaderboardItem);
                    });
                }
            });
        }

        // Initialize friends section
        function initializeFriends() {
            const copyReferralButton = document.getElementById('copyReferralButton');
            
            copyReferralButton.addEventListener('click', () => {
                const referralLink = `https://t.me/TrimintBot/open?startapp=${userData.id}`;
                
                navigator.clipboard.writeText(referralLink)
                    .then(() => {
                        showToast('Referral link copied to clipboard', 'success');
                    })
                    .catch(err => {
                        console.error('Failed to copy referral link: ', err);
                        showToast('Failed to copy referral link', 'error');
                    });
            });
            
            loadReferralsData();
        }

        // Load referrals data
        function loadReferralsData() {
            const referralsList = document.getElementById('referralsList');
            referralsList.innerHTML = '';
            
            let referralEarnings = 0;
            
            if (userData.referrals && userData.referrals.length > 0) {
                userData.referrals.forEach(referral => {
                    referralEarnings += referral.earned || 0;
                    
                    const referralItem = document.createElement('div');
                    referralItem.className = 'referral-item';
                    
                    referralItem.innerHTML = `
                        <img src="${referral.photoUrl || 'https://i.postimg.cc/fTQktNmX/maincoin.png'}" alt="${referral.name}" class="referral-avatar">
                        <div class="referral-info">
                            <div class="referral-name">${referral.name}</div>
                            <div class="referral-details">ID: ${referral.id} | Balance: ${(referral.balance || 0).toFixed(3)} TRM</div>
                        </div>
                        <div class="referral-reward">
                            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                            <span>${(referral.earned || 0).toFixed(3)}</span>
                        </div>
                    `;
                    
                    referralsList.appendChild(referralItem);
                });
            } else {
                referralsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No referrals yet</p>';
            }
            
            document.getElementById('referralEarnings').textContent = referralEarnings.toFixed(3);
        }

        // Initialize profile section
        function initializeProfile() {
            // Profile data is already loaded in loadUserData()
        }

        // Initialize settings
        function initializeSettings() {
            const notificationsToggle = document.getElementById('notificationsToggle');
            const soundToggle = document.getElementById('soundToggle');
            const autoFarmingToggle = document.getElementById('autoFarmingToggle');
            
            notificationsToggle.addEventListener('click', () => {
                userData.settings.notifications = !userData.settings.notifications;
                notificationsToggle.classList.toggle('active');
                saveUserData();
            });
            
            soundToggle.addEventListener('click', () => {
                userData.settings.sound = !userData.settings.sound;
                soundToggle.classList.toggle('active');
                saveUserData();
            });
            
            autoFarmingToggle.addEventListener('click', () => {
                userData.settings.autoFarming = !userData.settings.autoFarming;
                autoFarmingToggle.classList.toggle('active');
                saveUserData();
                
                if (userData.settings.autoFarming && !userData.farmingActive) {
                    // Start farming automatically
                    const endTime = new Date();
                    endTime.setHours(endTime.getHours() + 12);
                    
                    const farmingButton = document.getElementById('farmingButton');
                    farmingButton.click();
                }
            });
        }

        // Save user data to Firebase
        function saveUserData() {
            database.ref('users/' + userData.id).update(userData);
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
