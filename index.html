<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trimint - Earn TRM Tokens</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --background: #ffffff;
            --surface: #f8fafc;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --coin-gradient: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
        }

        body.dark-theme {
            --background: #0f172a;
            --surface: #1e293b;
            --text: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        body {
            background: var(--background);
            color: var(--text);
            transition: all 0.3s ease;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-coin {
            width: 120px;
            height: 120px;
            background: var(--coin-gradient);
            border-radius: 50%;
            animation: pulse 2s infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(245, 158, 11, 0.4);
        }

        .loading-coin img {
            width: 80px;
            height: 80px;
            animation: rotate 3s linear infinite;
        }

        .referral-info {
            color: white;
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
            animation: fadeInUp 1s ease;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Header */
        .header {
            background: var(--gradient);
            padding: 20px;
            color: white;
            box-shadow: 0 4px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.3);
            object-fit: cover;
        }

        .user-details h2 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .user-level {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .balance-display {
            text-align: right;
        }

        .balance-amount {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
        }

        .balance-amount img {
            width: 30px;
            height: 30px;
        }

        .balance-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        /* Content Sections */
        .content {
            padding: 20px;
            min-height: calc(100vh - 200px);
        }

        .section {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .section.active {
            display: block;
        }

        /* Home Section - Farming */
        .farming-container {
            background: var(--surface);
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 10px 30px var(--shadow);
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .farming-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, var(--primary) 0%, transparent 70%);
            opacity: 0.05;
        }

        .coin-container {
            position: relative;
            z-index: 1;
            margin-bottom: 40px;
        }

        .main-coin {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            border-radius: 50%;
            background: var(--coin-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 15px 50px rgba(245, 158, 11, 0.3);
            position: relative;
            transition: all 0.3s ease;
        }

        .main-coin.farming {
            animation: pulse 1s infinite, glow 2s infinite;
        }

        .main-coin img {
            width: 100px;
            height: 100px;
            transition: all 0.3s ease;
        }

        .main-coin.farming img {
            animation: rotate 10s linear infinite;
        }

        .farming-status {
            margin: 30px 0;
        }

        .farming-timer {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
        }

        .farming-rate {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .farm-button {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .farm-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .farm-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .farm-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .farm-button:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        .token-animation {
            position: fixed;
            color: var(--success);
            font-weight: bold;
            font-size: 18px;
            pointer-events: none;
            animation: floatUp 2s ease-out forwards;
            z-index: 1000;
        }

        /* Tasks Section */
        .tasks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .watch-ads-button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .watch-ads-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }

        .task-card {
            background: var(--surface);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .task-card:hover::before {
            left: 100%;
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .task-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .task-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .task-info h3 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .task-reward {
            color: var(--primary);
            font-weight: bold;
            font-size: 14px;
        }

        .task-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .task-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }

        .task-button:hover {
            background: var(--primary-dark);
            transform: scale(1.02);
        }

        .task-button.processing {
            background: var(--secondary);
            animation: pulse 1s infinite;
        }

        .task-button.completed {
            background: var(--success);
        }

        /* Leaderboard */
        .leaderboard-list {
            background: var(--surface);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .leaderboard-item:last-child {
            border-bottom: none;
        }

        .rank-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin-right: 15px;
        }

        .rank-number.gold {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
        }

        .rank-number.silver {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
            color: #333;
        }

        .rank-number.bronze {
            background: linear-gradient(135deg, #cd7f32, #e4a853);
            color: white;
        }

        .leaderboard-user {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .leaderboard-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .leaderboard-details h4 {
            font-size: 14px;
            margin-bottom: 3px;
        }

        .leaderboard-level {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .leaderboard-balance {
            text-align: right;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
            color: var(--primary);
        }

        .leaderboard-balance img {
            width: 20px;
            height: 20px;
        }

        /* Friends Section */
        .referral-card {
            background: var(--gradient);
            border-radius: 20px;
            padding: 30px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .referral-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        .referral-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .referral-link-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .referral-link {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .referral-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 12px;
        }

        .copy-button {
            background: white;
            color: var(--primary);
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .copy-button:hover {
            transform: scale(1.05);
        }

        .referrals-list {
            background: var(--surface);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .referral-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .referral-item:last-child {
            border-bottom: none;
        }

        .referral-item:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .referral-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .referral-info {
            flex: 1;
        }

        .referral-name {
            font-weight: 600;
            margin-bottom: 3px;
        }

        .referral-details {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .referral-earned {
            text-align: right;
            color: var(--success);
            font-weight: bold;
        }

        /* Profile Section */
        .profile-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .profile-card {
            background: var(--surface);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: var(--gradient);
            opacity: 0.1;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 4px solid var(--primary);
            object-fit: cover;
        }

        .profile-info h2 {
            font-size: 22px;
            margin-bottom: 5px;
        }

        .profile-level {
            display: inline-block;
            background: var(--gradient);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .profile-stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .wallet-section {
            background: var(--gradient);
            border-radius: 15px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }

        .wallet-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .wallet-address {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            margin-bottom: 15px;
        }

        .wallet-buttons {
            display: flex;
            gap: 10px;
        }

        .wallet-button {
            flex: 1;
            background: white;
            color: var(--primary);
            border: none;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .wallet-button:hover {
            transform: scale(1.02);
        }

        .settings-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--text);
        }

        .settings-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: rgba(99, 102, 241, 0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-item:hover {
            background: rgba(99, 102, 241, 0.1);
            transform: translateX(5px);
        }

        .settings-item i {
            margin-right: 10px;
            color: var(--primary);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface);
            border-top: 1px solid var(--border);
            padding: 10px 0;
            box-shadow: 0 -5px 20px var(--shadow);
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 500px;
            margin: 0 auto;
        }

        .nav-button {
            background: none;
            border: none;
            padding: 8px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            position: relative;
        }

        .nav-button.home-button {
            transform: scale(1.2);
            padding: 12px;
        }

        .nav-button.home-button .nav-icon {
            width: 45px;
            height: 45px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 15px var(--shadow);
        }

        .nav-button.active {
            color: var(--primary);
        }

        .nav-button:hover {
            transform: translateY(-2px);
        }

        .nav-button.home-button:hover {
            transform: scale(1.3);
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 15px 50px rgba(245, 158, 11, 0.3);
            }
            50% {
                box-shadow: 0 15px 70px rgba(245, 158, 11, 0.5);
            }
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .header {
                padding: 15px;
            }

            .user-avatar {
                width: 40px;
                height: 40px;
            }

            .balance-amount {
                font-size: 20px;
            }

            .main-coin {
                width: 120px;
                height: 120px;
            }

            .main-coin img {
                width: 80px;
                height: 80px;
            }

            .farming-timer {
                font-size: 28px;
            }

            .profile-stats {
                grid-template-columns: 1fr;
            }

            .referral-stats {
                grid-template-columns: 1fr;
            }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px var(--shadow);
            z-index: 10000;
            opacity: 0;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .toast.show {
            opacity: 1;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-100%);
            }
            to {
                transform: translateX(-50%) translateY(0);
            }
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-coin">
            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM Coin">
        </div>
        <div class="referral-info" id="referralInfo" style="display: none;">
            <p>You were invited by: <strong id="referralName"></strong></p>
        </div>
        <div class="loader"></div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Header -->
    <header class="header">
        <button class="theme-toggle" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
        <div class="user-info">
            <div class="user-profile">
                <img class="user-avatar" id="userAvatar" src="https://via.placeholder.com/50" alt="User Avatar">
                <div class="user-details">
                    <h2 id="userName">Loading...</h2>
                    <span class="user-level" id="userLevel">Bronze</span>
                </div>
            </div>
            <div class="balance-display">
                <div class="balance-amount">
                    <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                    <span id="userBalance">0</span>
                </div>
                <div class="balance-label">TRM Balance</div>
            </div>
        </div>
    </header>

    <!-- Content -->
    <main class="content">
        <!-- Home Section -->
        <section class="section active" id="homeSection">
            <div class="farming-container">
                <div class="coin-container">
                    <div class="main-coin" id="mainCoin">
                        <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM Coin">
                    </div>
                </div>
                <div class="farming-status">
                    <div class="farming-timer" id="farmingTimer">12:00:00</div>
                    <div class="farming-rate">Earn 0.001 TRM per second</div>
                    <button class="farm-button" id="farmButton">Start Farming</button>
                </div>
            </div>
        </section>

        <!-- Tasks Section -->
        <section class="section" id="tasksSection">
            <div class="tasks-header">
                <h2>Tasks</h2>
                <button class="watch-ads-button" id="watchAdsButton">
                    <i class="fas fa-play"></i> Watch Ads (+1 TRM)
                </button>
            </div>
            <div id="tasksList">
                <!-- Tasks will be loaded from Firebase -->
            </div>
        </section>

        <!-- Leaderboard Section -->
        <section class="section" id="leaderboardSection">
            <h2 style="margin-bottom: 20px;">Top Users</h2>
            <div class="leaderboard-list" id="leaderboardList">
                <!-- Leaderboard will be loaded from Firebase -->
            </div>
        </section>

        <!-- Friends Section -->
        <section class="section" id="friendsSection">
            <div class="referral-card">
                <div class="referral-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="totalReferrals">0</div>
                        <div class="stat-label">Total Referrals</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="referralEarnings">0</div>
                        <div class="stat-label">Referral Earnings</div>
                    </div>
                </div>
                <div class="referral-link-container">
                    <div class="referral-link">
                        <input type="text" class="referral-input" id="referralInput" readonly>
                        <button class="copy-button" id="copyReferralButton">Copy</button>
                    </div>
                </div>
            </div>
            <div class="referrals-list">
                <h3 style="margin-bottom: 15px;">Your Referrals</h3>
                <div id="referralsList">
                    <!-- Referrals will be loaded from Firebase -->
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section class="section" id="profileSection">
            <div class="profile-container">
                <div class="profile-card">
                    <div class="profile-header">
                        <img class="profile-avatar" id="profileAvatar" src="https://via.placeholder.com/80" alt="Profile">
                        <div class="profile-info">
                            <h2 id="profileName">Loading...</h2>
                            <span class="profile-level" id="profileLevel">Bronze</span>
                        </div>
                    </div>
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileBalance">0</div>
                            <div class="profile-stat-label">TRM Balance</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileFriends">0</div>
                            <div class="profile-stat-label">Friends Invited</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileTasks">0</div>
                            <div class="profile-stat-label">Tasks Completed</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value" id="profileRank">-</div>
                            <div class="profile-stat-label">Global Rank</div>
                        </div>
                    </div>
                </div>

                <div class="wallet-section">
                    <h3 style="margin-bottom: 15px;">TON Wallet</h3>
                    <div class="wallet-status">
                        <span id="walletStatus">Not Connected</span>
                    </div>
                    <div class="wallet-address" id="walletAddress" style="display: none;">
                        <!-- Wallet address will be shown here -->
                    </div>
                    <div class="wallet-buttons">
                        <button class="wallet-button" id="connectWalletButton">Connect Wallet</button>
                        <button class="wallet-button" id="disconnectWalletButton" style="display: none;">Disconnect</button>
                        <button class="wallet-button" id="copyAddressButton" style="display: none;">Copy Address</button>
                    </div>
                </div>

                <div class="profile-card settings-section">
                    <h3>Settings</h3>
                    <div class="settings-list">
                        <div class="settings-item" onclick="showNotifications()">
                            <span><i class="fas fa-bell"></i> Notifications</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" onclick="showPrivacy()">
                            <span><i class="fas fa-shield-alt"></i> Privacy</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" onclick="showHelp()">
                            <span><i class="fas fa-question-circle"></i> Help & Support</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" onclick="showAbout()">
                            <span><i class="fas fa-info-circle"></i> About</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-container">
            <button class="nav-button" data-section="home">
                <i class="fas fa-home nav-icon"></i>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-button home-button active" data-section="home">
                <div class="nav-icon">
                    <i class="fas fa-coins"></i>
                </div>
                <span class="nav-label">Farm</span>
            </button>
            <button class="nav-button" data-section="tasks">
                <i class="fas fa-tasks nav-icon"></i>
                <span class="nav-label">Tasks</span>
            </button>
            <button class="nav-button" data-section="leaderboard">
                <i class="fas fa-trophy nav-icon"></i>
                <span class="nav-label">Leaderboard</span>
            </button>
            <button class="nav-button" data-section="friends">
                <i class="fas fa-users nav-icon"></i>
                <span class="nav-label">Friends</span>
            </button>
            <button class="nav-button" data-section="profile">
                <i class="fas fa-user nav-icon"></i>
                <span class="nav-label">Profile</span>
            </button>
        </div>
    </nav>

    <!-- Monetag Ads Script -->
    <script src='//libtl.com/sdk.js' data-zone='10290264' data-sdk='show_10290264'></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAt9PRbvok0g5XL4187btrPvGx6VjfurJU",
            authDomain: "msc-by-shawon.firebaseapp.com",
            projectId: "msc-by-shawon",
            storageBucket: "msc-by-shawon.firebasestorage.app",
            messagingSenderId: "432753389120",
            appId: "1:432753389120:web:dcbb46ca39408a405579a5",
            measurementId: "G-8LHGLJSSEE"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        // Telegram Bot API Integration
        const telegramBotToken = '8099896534:AAFmOTkOjLC8RSSJy-dXtjPQotF3hJlyXTQ';
        let telegramUser = null;
        let currentUserId = null;

        // App State
        let appState = {
            balance: 0,
            level: 'Bronze',
            farming: false,
            farmingStartTime: null,
            farmingEndTime: null,
            totalReferrals: 0,
            referralEarnings: 0,
            tasksCompleted: 0,
            walletConnected: false,
            walletAddress: null,
            referredUsers: [],
            completedTasks: []
        };

        // Initialize Telegram WebApp
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                const webApp = window.Telegram.WebApp;
                webApp.ready();
                webApp.expand();
                
                // Get user data from Telegram
                if (webApp.initDataUnsafe && webApp.initDataUnsafe.user) {
                    telegramUser = webApp.initDataUnsafe.user;
                    currentUserId = telegramUser.id.toString();
                    
                    // Set user info
                    document.getElementById('userName').textContent = telegramUser.first_name + ' ' + (telegramUser.last_name || '');
                    document.getElementById('profileName').textContent = telegramUser.first_name + ' ' + (telegramUser.last_name || '');
                    
                    if (telegramUser.photo_url) {
                        document.getElementById('userAvatar').src = telegramUser.photo_url;
                        document.getElementById('profileAvatar').src = telegramUser.photo_url;
                    }
                    
                    // Initialize user in Firebase
                    initializeUserInFirebase();
                }
            } else {
                // Fallback for testing
                telegramUser = {
                    id: 123456,
                    first_name: 'Test',
                    last_name: 'User',
                    photo_url: 'https://via.placeholder.com/80'
                };
                currentUserId = telegramUser.id.toString();
                document.getElementById('userName').textContent = 'Test User';
                document.getElementById('profileName').textContent = 'Test User';
                initializeUserInFirebase();
            }
        }

        // Initialize user in Firebase
        async function initializeUserInFirebase() {
            try {
                const userDoc = await db.collection('users').doc(currentUserId).get();
                
                if (!userDoc.exists) {
                    // New user, create document
                    const userData = {
                        telegramId: currentUserId,
                        firstName: telegramUser.first_name,
                        lastName: telegramUser.last_name || '',
                        photoUrl: telegramUser.photo_url || '',
                        balance: 0,
                        level: 'Bronze',
                        farming: false,
                        farmingStartTime: null,
                        farmingEndTime: null,
                        totalReferrals: 0,
                        referralEarnings: 0,
                        tasksCompleted: 0,
                        walletConnected: false,
                        walletAddress: null,
                        referredUsers: [],
                        completedTasks: [],
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    await db.collection('users').doc(currentUserId).set(userData);
                    
                    // Check for referral
                    checkReferral();
                } else {
                    // Existing user, load data
                    appState = { ...appState, ...userDoc.data() };
                    updateUI();
                    
                    // Update last active
                    await db.collection('users').doc(currentUserId).update({
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                // Load user data
                loadUserData();
                
            } catch (error) {
                console.error('Error initializing user:', error);
                showToast('Error initializing user data');
            }
        }

        // Check for referral
        function checkReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const referralCode = urlParams.get('startapp');
            
            if (referralCode && referralCode !== currentUserId) {
                // User was referred
                const referrerId = referralCode.replace('user', '');
                
                // Show referral info on loading screen
                db.collection('users').doc(referrerId).get().then((doc) => {
                    if (doc.exists) {
                        const referrerData = doc.data();
                        document.getElementById('referralName').textContent = referrerData.firstName;
                        document.getElementById('referralInfo').style.display = 'block';
                        
                        // Give referrer 5000 TRM
                        db.collection('users').doc(referrerId).update({
                            balance: firebase.firestore.FieldValue.increment(5000),
                            referralEarnings: firebase.firestore.FieldValue.increment(5000),
                            referredUsers: firebase.firestore.FieldValue.arrayUnion(currentUserId)
                        });
                        
                        // Add referral to current user
                        setTimeout(() => {
                            db.collection('users').doc(currentUserId).update({
                                referredBy: referrerId
                            });
                        }, 2000);
                    }
                }).catch(error => {
                    console.error('Error checking referral:', error);
                });
            }
        }

        // Load user data from Firebase
        async function loadUserData() {
            try {
                const userDoc = await db.collection('users').doc(currentUserId).get();
                if (userDoc.exists) {
                    appState = { ...appState, ...userDoc.data() };
                    updateUI();
                    
                    // Load tasks
                    loadTasks();
                    
                    // Load leaderboard
                    loadLeaderboard();
                    
                    // Load referrals
                    loadReferrals();
                    
                    // Set referral link
                    const referralLink = `https://t.me/TrimintBot/open?startapp=user${currentUserId}`;
                    document.getElementById('referralInput').value = referralLink;
                    
                    // Hide loading screen
                    setTimeout(() => {
                        document.getElementById('loadingScreen').classList.add('hidden');
                    }, 3000);
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Error loading data');
            }
        }

        // Update UI with current state
        function updateUI() {
            // Update balance
            document.getElementById('userBalance').textContent = Math.floor(appState.balance).toLocaleString();
            document.getElementById('profileBalance').textContent = Math.floor(appState.balance).toLocaleString();
            
            // Update level
            const level = calculateLevel(appState.balance);
            appState.level = level;
            document.getElementById('userLevel').textContent = level;
            document.getElementById('profileLevel').textContent = level;
            
            // Update profile stats
            document.getElementById('profileFriends').textContent = appState.totalReferrals;
            document.getElementById('profileTasks').textContent = appState.tasksCompleted;
            
            // Update referral stats
            document.getElementById('totalReferrals').textContent = appState.totalReferrals;
            document.getElementById('referralEarnings').textContent = Math.floor(appState.referralEarnings).toLocaleString();
            
            // Update wallet status
            if (appState.walletConnected && appState.walletAddress) {
                document.getElementById('walletStatus').textContent = 'Connected';
                document.getElementById('connectWalletButton').style.display = 'none';
                document.getElementById('disconnectWalletButton').style.display = 'block';
                document.getElementById('copyAddressButton').style.display = 'block';
                
                const shortAddress = appState.walletAddress.substring(0, 6) + '...' + appState.walletAddress.substring(appState.walletAddress.length - 4);
                document.getElementById('walletAddress').textContent = appState.walletAddress;
                document.getElementById('walletAddress').style.display = 'block';
            }
            
            // Update farming status
            if (appState.farming) {
                updateFarmingTimer();
            }
        }

        // Calculate user level based on balance
        function calculateLevel(balance) {
            if (balance < 10000) return 'Bronze';
            if (balance < 50000) return 'Gold';
            return 'Diamond';
        }

        // Load tasks from Firebase
        async function loadTasks() {
            try {
                const tasksSnapshot = await db.collection('tasks').orderBy('order', 'asc').get();
                const tasksList = document.getElementById('tasksList');
                tasksList.innerHTML = '';
                
                tasksSnapshot.forEach((doc) => {
                    const task = doc.data();
                    const isCompleted = appState.completedTasks.includes(doc.id);
                    
                    const taskCard = document.createElement('div');
                    taskCard.className = 'task-card';
                    taskCard.innerHTML = `
                        <div class="task-header">
                            <div class="task-icon">
                                <i class="fas ${task.icon || 'fa-star'}"></i>
                            </div>
                            <div class="task-info">
                                <h3>${task.name}</h3>
                                <div class="task-reward">Reward: ${task.reward} TRM</div>
                            </div>
                        </div>
                        <div class="task-description">${task.description}</div>
                        <button class="task-button ${isCompleted ? 'completed' : ''}" 
                                onclick="handleTaskClick('${doc.id}', '${task.link}', ${task.reward})"
                                ${isCompleted ? '' : 'id="task-' + doc.id + '"'}>
                            ${isCompleted ? 'Completed' : 'OPEN'}
                        </button>
                    `;
                    tasksList.appendChild(taskCard);
                });
            } catch (error) {
                console.error('Error loading tasks:', error);
                showToast('Error loading tasks');
            }
        }

        // Handle task click
        async function handleTaskClick(taskId, link, reward) {
            if (appState.completedTasks.includes(taskId)) {
                // Task already completed, still open link
                window.open(link, '_blank');
                return;
            }
            
            const button = document.getElementById(`task-${taskId}`);
            if (button) {
                button.textContent = 'Processing';
                button.classList.add('processing');
                button.disabled = true;
                
                // Open the task link
                window.open(link, '_blank');
                
                // Wait 10 seconds then give reward
                setTimeout(async () => {
                    try {
                        // Update user balance and completed tasks
                        await db.collection('users').doc(currentUserId).update({
                            balance: firebase.firestore.FieldValue.increment(reward),
                            tasksCompleted: firebase.firestore.FieldValue.increment(1),
                            completedTasks: firebase.firestore.FieldValue.arrayUnion(taskId)
                        });
                        
                        appState.balance += reward;
                        appState.tasksCompleted++;
                        appState.completedTasks.push(taskId);
                        
                        // Update button
                        button.textContent = 'Completed';
                        button.classList.remove('processing');
                        button.classList.add('completed');
                        
                        // Update UI
                        updateUI();
                        
                        // Show success message
                        showToast(`+${reward} TRM earned!`);
                        
                        // Show token animation
                        showTokenAnimation(reward);
                        
                    } catch (error) {
                        console.error('Error completing task:', error);
                        button.textContent = 'OPEN';
                        button.classList.remove('processing');
                        button.disabled = false;
                        showToast('Error completing task');
                    }
                }, 10000);
            }
        }

        // Load leaderboard
        async function loadLeaderboard() {
            try {
                const usersSnapshot = await db.collection('users')
                    .orderBy('balance', 'desc')
                    .limit(25)
                    .get();
                
                const leaderboardList = document.getElementById('leaderboardList');
                leaderboardList.innerHTML = '';
                
                let rank = 1;
                usersSnapshot.forEach((doc) => {
                    const user = doc.data();
                    const isCurrentUser = user.telegramId === currentUserId;
                    
                    const item = document.createElement('div');
                    item.className = 'leaderboard-item';
                    if (isCurrentUser) {
                        item.style.background = 'rgba(99, 102, 241, 0.1)';
                    }
                    
                    let rankClass = '';
                    if (rank === 1) rankClass = 'gold';
                    else if (rank === 2) rankClass = 'silver';
                    else if (rank === 3) rankClass = 'bronze';
                    
                    item.innerHTML = `
                        <div class="rank-number ${rankClass}">${rank}</div>
                        <div class="leaderboard-user">
                            <img class="leaderboard-avatar" src="${user.photoUrl || 'https://via.placeholder.com/40'}" alt="${user.firstName}">
                            <div class="leaderboard-details">
                                <h4>${user.firstName} ${user.lastName}</h4>
                                <div class="leaderboard-level">${calculateLevel(user.balance)}</div>
                            </div>
                        </div>
                        <div class="leaderboard-balance">
                            <img src="https://i.postimg.cc/fTQktNmX/maincoin.png" alt="TRM">
                            ${Math.floor(user.balance).toLocaleString()}
                        </div>
                    `;
                    
                    leaderboardList.appendChild(item);
                    
                    // Update current user rank
                    if (isCurrentUser) {
                        document.getElementById('profileRank').textContent = rank;
                    }
                    
                    rank++;
                });
            } catch (error) {
                console.error('Error loading leaderboard:', error);
            }
        }

        // Load referrals
        async function loadReferrals() {
            try {
                if (!appState.referredUsers || appState.referredUsers.length === 0) {
                    document.getElementById('referralsList').innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No referrals yet</p>';
                    return;
                }
                
                const referralsList = document.getElementById('referralsList');
                referralsList.innerHTML = '';
                
                for (const referralId of appState.referredUsers) {
                    const userDoc = await db.collection('users').doc(referralId).get();
                    if (userDoc.exists) {
                        const user = userDoc.data();
                        
                        const item = document.createElement('div');
                        item.className = 'referral-item';
                        item.innerHTML = `
                            <img class="referral-avatar" src="${user.photoUrl || 'https://via.placeholder.com/40'}" alt="${user.firstName}">
                            <div class="referral-info">
                                <div class="referral-name">${user.firstName} ${user.lastName}</div>
                                <div class="referral-details">ID: ${user.telegramId} | Balance: ${Math.floor(user.balance).toLocaleString()} TRM</div>
                            </div>
                            <div class="referral-earned">+5000 TRM</div>
                        `;
                        referralsList.appendChild(item);
                    }
                }
            } catch (error) {
                console.error('Error loading referrals:', error);
            }
        }

        // Farming functionality
        let farmingInterval = null;

        async function startFarming() {
            if (appState.farming) return;
            
            const now = Date.now();
            const endTime = now + (12 * 60 * 60 * 1000); // 12 hours
            
            try {
                await db.collection('users').doc(currentUserId).update({
                    farming: true,
                    farmingStartTime: now,
                    farmingEndTime: endTime
                });
                
                appState.farming = true;
                appState.farmingStartTime = now;
                appState.farmingEndTime = endTime;
                
                document.getElementById('mainCoin').classList.add('farming');
                document.getElementById('farmButton').textContent = 'Farming...';
                document.getElementById('farmButton').disabled = true;
                
                updateFarmingTimer();
                
                // Start farming interval
                farmingInterval = setInterval(async () => {
                    const currentTime = Date.now();
                    if (currentTime >= appState.farmingEndTime) {
                        // Farming complete
                        stopFarming();
                        showToast('Farming completed! You earned 43.2 TRM');
                    } else {
                        // Add 0.001 TRM per second
                        await db.collection('users').doc(currentUserId).update({
                            balance: firebase.firestore.FieldValue.increment(0.001)
                        });
                        appState.balance += 0.001;
                        updateUI();
                        updateFarmingTimer();
                        
                        // Show token animation occasionally
                        if (Math.random() < 0.1) {
                            showTokenAnimation(0.001);
                        }
                    }
                }, 1000);
                
            } catch (error) {
                console.error('Error starting farming:', error);
                showToast('Error starting farming');
            }
        }

        async function stopFarming() {
            if (farmingInterval) {
                clearInterval(farmingInterval);
                farmingInterval = null;
            }
            
            try {
                await db.collection('users').doc(currentUserId).update({
                    farming: false,
                    farmingStartTime: null,
                    farmingEndTime: null
                });
                
                appState.farming = false;
                appState.farmingStartTime = null;
                appState.farmingEndTime = null;
                
                document.getElementById('mainCoin').classList.remove('farming');
                document.getElementById('farmButton').textContent = 'Start Farming';
                document.getElementById('farmButton').disabled = false;
                document.getElementById('farmingTimer').textContent = '12:00:00';
                
            } catch (error) {
                console.error('Error stopping farming:', error);
            }
        }

        function updateFarmingTimer() {
            if (!appState.farmingEndTime) return;
            
            const now = Date.now();
            const remaining = Math.max(0, appState.farmingEndTime - now);
            
            const hours = Math.floor(remaining / (1000 * 60 * 60));
            const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
            
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('farmingTimer').textContent = timeString;
        }

        // TON Wallet Connection
        async function connectWallet() {
            try {
                // Open Trimint wallet connection
                window.open('https://trimint.vercel.app/', '_blank');
                
                // For demo purposes, simulate wallet connection
                setTimeout(() => {
                    const mockAddress = 'EQD1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef';
                    appState.walletConnected = true;
                    appState.walletAddress = mockAddress;
                    
                    db.collection('users').doc(currentUserId).update({
                        walletConnected: true,
                        walletAddress: mockAddress
                    });
                    
                    updateUI();
                    showToast('Wallet connected successfully!');
                }, 2000);
                
            } catch (error) {
                console.error('Error connecting wallet:', error);
                showToast('Error connecting wallet');
            }
        }

        async function disconnectWallet() {
            try {
                await db.collection('users').doc(currentUserId).update({
                    walletConnected: false,
                    walletAddress: null
                });
                
                appState.walletConnected = false;
                appState.walletAddress = null;
                
                updateUI();
                showToast('Wallet disconnected');
                
            } catch (error) {
                console.error('Error disconnecting wallet:', error);
                showToast('Error disconnecting wallet');
            }
        }

        function copyWalletAddress() {
            if (appState.walletAddress) {
                navigator.clipboard.writeText(appState.walletAddress).then(() => {
                    showToast('Wallet address copied!');
                }).catch(() => {
                    showToast('Failed to copy address');
                });
            }
        }

        // Copy referral link
        function copyReferralLink() {
            const referralInput = document.getElementById('referralInput');
            referralInput.select();
            document.execCommand('copy');
            showToast('Referral link copied!');
        }

        // Watch ads for TRM
        function watchAds() {
            // Show Monetag ads
            if (window.show_10290264) {
                window.show_10290264();
                
                // Give 1 TRM after ad
                setTimeout(async () => {
                    try {
                        await db.collection('users').doc(currentUserId).update({
                            balance: firebase.firestore.FieldValue.increment(1)
                        });
                        
                        appState.balance += 1;
                        updateUI();
                        showToast('+1 TRM earned from ad!');
                        showTokenAnimation(1);
                        
                    } catch (error) {
                        console.error('Error adding ad reward:', error);
                    }
                }, 5000);
            } else {
                showToast('Ad service not available');
            }
        }

        // Show token animation
        function showTokenAnimation(amount) {
            const tokenElement = document.createElement('div');
            tokenElement.className = 'token-animation';
            tokenElement.textContent = `+${amount.toFixed(3)} TRM`;
            tokenElement.style.left = Math.random() * window.innerWidth + 'px';
            tokenElement.style.top = (window.innerHeight / 2) + 'px';
            
            document.body.appendChild(tokenElement);
            
            setTimeout(() => {
                tokenElement.remove();
            }, 2000);
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            const icon = document.querySelector('#themeToggle i');
            icon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
            
            // Save theme preference
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId + 'Section').classList.add('active');
            
            // Update nav buttons
            document.querySelectorAll('.nav-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Set active button
            const activeButton = document.querySelector(`[data-section="${sectionId}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
            
            // Also activate home button if farm is selected
            if (sectionId === 'home') {
                document.querySelector('.nav-button.home-button').classList.add('active');
            }
        }

        // Settings functions
        function showNotifications() {
            showToast('Notifications settings coming soon');
        }

        function showPrivacy() {
            showToast('Privacy settings coming soon');
        }

        function showHelp() {
            showToast('Help & Support coming soon');
        }

        function showAbout() {
            showToast('Trimint v1.0 - Earn TRM Tokens');
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                document.querySelector('#themeToggle i').className = 'fas fa-sun';
            }
            
            // Initialize Telegram WebApp
            initTelegramWebApp();
            
            // Navigation
            document.querySelectorAll('.nav-button').forEach(button => {
                button.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    showSection(section);
                });
            });
            
            // Farming
            document.getElementById('farmButton').addEventListener('click', startFarming);
            
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Wallet
            document.getElementById('connectWalletButton').addEventListener('click', connectWallet);
            document.getElementById('disconnectWalletButton').addEventListener('click', disconnectWallet);
            document.getElementById('copyAddressButton').addEventListener('click', copyWalletAddress);
            
            // Referral
            document.getElementById('copyReferralButton').addEventListener('click', copyReferralLink);
            
            // Ads
            document.getElementById('watchAdsButton').addEventListener('click', watchAds);
            
            // Update timer every second if farming
            setInterval(() => {
                if (appState.farming) {
                    updateFarmingTimer();
                }
            }, 1000);
            
            // Refresh leaderboard every 30 seconds
            setInterval(() => {
                loadLeaderboard();
            }, 30000);
        });

        // Handle TON wallet callback (for real integration)
        window.addEventListener('message', function(event) {
            if (event.data.type === 'ton-wallet-connected') {
                appState.walletConnected = true;
                appState.walletAddress = event.data.address;
                
                db.collection('users').doc(currentUserId).update({
                    walletConnected: true,
                    walletAddress: event.data.address
                });
                
                updateUI();
                showToast('TON Wallet connected successfully!');
            }
        });

        // Telegram WebApp back button
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.BackButton.onClick(function() {
                window.Telegram.WebApp.close();
            });
        }
    </script>
</body>
</html>
